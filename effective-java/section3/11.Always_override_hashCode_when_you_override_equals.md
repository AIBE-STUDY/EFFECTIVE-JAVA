# 11. equalsë¥¼ ì¬ì •ì˜í•˜ë ¤ê±°ë“  hashCodeë„ ì¬ì •ì˜í•˜ë¼

### ğŸ”‘ í•µì‹¬ ë‚´ìš©

âœ” equalsë¥¼ ì¬ì •ì˜í•œ í´ë˜ìŠ¤ëŠ” ë°˜ë“œì‹œ hashCodeë„ ì¬ì •ì˜í•´ì•¼ í•œë‹¤
ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ HashMap, HashSet ê°™ì€ ì»¬ë ‰ì…˜ì—ì„œ ë¬¸ì œê°€ ìƒê¸´ë‹¤
âœ” ì¢‹ì€ Hashcode ë§Œë“¤ê¸°

<br>

---

# hashCodeë€ ë¬´ì—‡ì¼ê¹Œ?

- hashCodeëŠ” ê°ì²´ë¥¼ êµ¬ë¶„í•˜ëŠ” ì •ìˆ˜ê°’(ìˆ«ì)ì´ë‹¤
- ì´ ìˆ«ìëŠ” í•´ì‹œ ê¸°ë°˜ ìë£Œêµ¬ì¡°ì—ì„œ ê°ì²´ë¥¼ ë¹¨ë¦¬ ì°¾ëŠ” ë° ì‚¬ìš©í•œë‹¤

<br>

## hashCode ê·œì•½

1. ì‹¤í–‰ ì¤‘ì—ëŠ” ê°™ì€ ê°ì²´ì˜ hashCode() ê°’ì´ ë³€í•˜ë©´ ì•ˆ ëœë‹¤
2. equalsë¡œ ê°™ë‹¤ê³  íŒë‹¨ëœ ë‘ ê°ì²´ëŠ” ê°™ì€ hashCode ê°’ì„ ê°€ì ¸ì•¼ í•œë‹¤
3. equalsë¡œ ë‹¤ë¥´ë‹¤ê³  íŒë‹¨ëœ ë‘ ê°ì²´ì˜ hashCodeëŠ” ë‹¤ë¥¼ ìˆ˜ë„, ê°™ì„ ìˆ˜ë„ ìˆë‹¤

<br>

### ğŸš« ë‚˜ìœ ì˜ˆì‹œ : equalsë§Œ ì¬ì •ì˜í•˜ê³  hashCodeëŠ” ì¬ì •ì˜í•˜ì§€ ì•Šì€ ê²½ìš°

```java
public class Student {
    private String name;
    private int grade;

    // ìƒì„±ì
    public Student(String name, int grade) {
        this.name = name;
        this.grade = grade;
    }

    // equalsë§Œ ì¬ì •ì˜ (ì´ë¦„ê³¼ í•™ë…„ì´ ê°™ìœ¼ë©´ ê°™ì€ í•™ìƒ)
    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Student student = (Student) o;
        return grade == student.grade &&
               Objects.equals(name, student.name);
    }

    // hashCodeëŠ” ì¬ì •ì˜í•˜ì§€ ì•ŠìŒ!
}

public static void main(String[] args) {
    Map<Student, String> studentMap = new HashMap<>();

    // ì²« ë²ˆì§¸ ë¯¼ìˆ˜ ê°ì²´ ìƒì„±
    Student student1 = new Student("ë¯¼ìˆ˜", 3);
    // ë‘ ë²ˆì§¸ ë¯¼ìˆ˜ ê°ì²´ ìƒì„± (equalsë¡œëŠ” ê°™ì€ í•™ìƒ)
    Student student2 = new Student("ë¯¼ìˆ˜", 3);

    // ì²« ë²ˆì§¸ ë¯¼ìˆ˜ë¥¼ ë§µì— ì €ì¥
    studentMap.put(student1, "ì¶œì„");

    // ë‘ ë²ˆì§¸ ë¯¼ìˆ˜ì˜ ì •ë³´ë¥¼ ì¡°íšŒ
    String status = studentMap.get(student2);

    System.out.println("ë¯¼ìˆ˜ì˜ ìƒíƒœ: " + status); // nullì´ ì¶œë ¥ë¨
}

```

<br>

### âœ… ì¢‹ì€ ì˜ˆì‹œ : equalsì™€ hashCode ë‘˜ë‹¤ ì¬ì •ì˜ í•œ ê²½ìš°

```java
public class Student {
    private String name;
    private int grade;

    // ìƒì„±ì
    public Student(String name, int grade) {
        this.name = name;
        this.grade = grade;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Student student = (Student) o;
        return grade == student.grade &&
               Objects.equals(name, student.name);
    }

    @Override
    public int hashCode() {
        int result = name != null ? name.hashCode() : 0;
        result = 31 * result + grade;
        return result;
    }
}

// ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ
public static void main(String[] args) {
    Map<Student, String> studentMap = new HashMap<>();

    // ì²« ë²ˆì§¸ ë¯¼ìˆ˜ ê°ì²´ ìƒì„±
    Student student1 = new Student("ë¯¼ìˆ˜", 3);
    // ë‘ ë²ˆì§¸ ë¯¼ìˆ˜ ê°ì²´ ìƒì„± (equalsë¡œëŠ” ê°™ì€ í•™ìƒ)
    Student student2 = new Student("ë¯¼ìˆ˜", 3);

    // ì²« ë²ˆì§¸ ë¯¼ìˆ˜ë¥¼ ë§µì— ì €ì¥
    studentMap.put(student1, "ì¶œì„");

    // hashCodeë¥¼ ì¬ì •ì˜í–ˆìœ¼ë¯€ë¡œ ë‘ ë²ˆì§¸ ë¯¼ìˆ˜ì˜ ì •ë³´ë¥¼ ì œëŒ€ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆìŒ
    String status = studentMap.get(student2);

    System.out.println("ë¯¼ìˆ˜ì˜ ìƒíƒœ: " + status); // "ì¶œì„"ì´ ì¶œë ¥ë¨!

    // HashSetì—ì„œë„ ì œëŒ€ë¡œ ë™ì‘
    Set<Student> studentSet = new HashSet<>();
    studentSet.add(student1);

    // ì´ë¯¸ ê°™ì€ í•™ìƒì´ ìˆì–´ì„œ false ë°˜í™˜
    boolean added = studentSet.add(student2);
    System.out.println("ì¶”ê°€ ì—¬ë¶€: " + added); // false ì¶œë ¥
    System.out.println("Set í¬ê¸°: " + studentSet.size()); // 1 ì¶œë ¥
}
```

<br>

<img width="527" alt="Image" src="https://github.com/user-attachments/assets/363c698d-0c11-40c1-a749-cb6d1aaf9f5c" />

<br>

## ì¢‹ì€ hashCode ë§Œë“œëŠ” ë²•

1. int ë³€ìˆ˜ resultë¥¼ ì„ ì–¸í•˜ê³  ì²« ë²ˆì§¸ í•„ë“œì˜ í•´ì‹œì½”ë“œë¡œ ì´ˆê¸°í™”
2. ë‚˜ë¨¸ì§€ í•„ë“œì˜ í•´ì‹œì½”ë“œë¥¼ ê³„ì‚°í•´ì„œ result ê°’ì— ë”í•¨
   ```java
   result = 31 * result + c   // cëŠ” í•„ë“œì˜ í•´ì‹œì½”ë“œ
   ```
3. result ê°’ì„ ë¦¬í„´

### hashCode() ì‘ì„± ì˜ˆì‹œ

```java
class Person {
    String name;
    int age;

    @Override
    public int hashCode() {
        int result = name.hashCode(); // 1ï¸âƒ£ ì²« ë²ˆì§¸ í•µì‹¬ í•„ë“œ ì‚¬ìš©
        result = 31 * result + age;   // 2ï¸âƒ£ 31ì„ ê³±í•œ í›„ ë‘ ë²ˆì§¸ í•„ë“œ ì¶”ê°€
        return result;                // 3ï¸âƒ£ ìµœì¢… í•´ì‹œì½”ë“œ ë°˜í™˜
    }
}
```

<br>

### hashCode() ì‘ì„± ì‹œ ê³ ë ¤í•´ì•¼ í•  ì‚¬í•­

- ìˆ«ì íƒ€ì… (int, long ë“±) â†’ ê·¸ëƒ¥ ì‚¬ìš©
- ë¬¸ìì—´ (String) â†’ .hashCode() í˜¸ì¶œ
- ê°ì²´ â†’ í•´ë‹¹ ê°ì²´ì˜ hashCode() ì‚¬ìš©
- ë°°ì—´ â†’ Arrays.hashCode() ì‚¬ìš©
- null ê°’ â†’ 0 ì‚¬ìš©

<br>

### ì™œ 31ì„ ê³±í• ê¹Œ?

1. 31ì€ ì†Œìˆ˜(Prime Number)ë¼ì„œ í•´ì‹œ ì¶©ëŒì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤
2. 31ì€ í™€ìˆ˜ë¼ì„œ ì˜¤ë²„í”Œë¡œìš° ë°œìƒ ì‹œ ì •ë³´ ì†ì‹¤ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤
3. 31 \* xëŠ” (x << 5) - xë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ ì—°ì‚° ì†ë„ê°€ ë¹ ë¥´ë‹¤

   ```java
   31 * x == (x << 5) - x
   ```

   x << 5 ëŠ” x _ 32 ì™€ ê°™ìŒ (ì™¼ìª½ìœ¼ë¡œ 5ë¹„íŠ¸ ì´ë™ = 2^5 = 32 ê³±í•˜ê¸°)
   ì¦‰, 31 _ x ë¥¼ 32 \* x - x ë¡œ ë³€ê²½í•˜ë©´ ë¹ ë¥¸ ì—°ì‚°ì´ ê°€ëŠ¥!

<br>

### ë” ì‰¬ìš´ ë°©ë²•: Objects.hash ì‚¬ìš©í•˜ê¸°

- Objects.hash ë¥¼ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ì§€ë§Œ, ì„±ëŠ¥ì´ ì €í•˜ ëœë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤
- ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì•„ë‹Œ ì¼ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì´ ì„±ëŠ¥ ì°¨ì´ê°€ í¬ê²Œ ë¬¸ì œë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤

```java
@Override
public int hashCode() {
    return Objects.hash(name, grade);
}
```

<br>

---

## ğŸ§© ì–´ë ¤ì› ë˜ ì 

- hashCode()ë¥¼ ì™œ ì¬ì •ì˜í•´ì•¼ í•˜ëŠ”ì§€ ì²˜ìŒì—ëŠ” ì´í•´í•˜ê¸° ì–´ë ¤ì› ìŒ.
- equals()ì™€ hashCode()ì˜ ê´€ê³„ë¥¼ ì •í™•íˆ ì •ë¦¬í•˜ëŠ” ê²ƒì´ í—·ê°ˆë ¸ë‹¤
- ìë°”ê°€ ìë™ìœ¼ë¡œ í•´ê²°í•´ì£¼ì§€ ì•Šì•„ì„œ ê°œë°œìê°€ ì§ì ‘ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ë¼ ì²˜ìŒì—ëŠ” ì–´ë ¤ì› ë‹¤

<br>

## ğŸ’­ ëŠë‚€ ì 

- hashCode()ë¥¼ ì¬ì •ì˜í•˜ì§€ ì•Šìœ¼ë©´, ê°™ì€ ê°ì²´ë¼ë„ ì»¬ë ‰ì…˜ì—ì„œ ì°¾ì§€ ëª»í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì— ë†€ëë‹¤
- 31ì„ ê³±í•˜ëŠ” ì´ìœ ê°€ ë‹¨ìˆœí•œ ìµœì í™”ê°€ ì•„ë‹ˆë¼, ì‹¤ì œ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤ëŠ” ì ì´ í¥ë¯¸ë¡œì› ë‹¤
