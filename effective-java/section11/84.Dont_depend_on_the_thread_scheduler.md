# 84. í”„ë¡œê·¸ëž¨ì˜ ë™ìž‘ì„ ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ê¸°ëŒ€ì§€ ë§ë¼

ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ ì¤‘ì¼ ë•Œ **ì–´ë–¤ ìŠ¤ë ˆë“œë¥¼ ì–¼ë§ˆë‚˜ ì˜¤ëž˜ ì‹¤í–‰í• ì§€ ê²°ì •í•˜ëŠ”** ìš´ì˜ì²´ì œì˜ í•œ ë¶€ë¶„ì´ë‹¤.

ë§ˆì¹˜ ë†€ì´í„°ì—ì„œ ì—¬ëŸ¬ ì¹œêµ¬ë“¤ì´ ë¯¸ë„ëŸ¼í‹€ì„ íƒ€ë ¤ê³  í•  ë•Œ, ì„ ìƒë‹˜ì´ ëˆ„êµ¬ë¥¼ ë¨¼ì € íƒœìš°ê³  ì–¼ë§ˆë‚˜ ì˜¤ëž˜ íƒ€ê²Œ í• ì§€ ê²°ì •í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•˜ë‹¤.

```java
// ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê°„ë‹¨í•œ ì˜ˆì‹œ
public class ThreadExample {
    public static void main(String[] args) {
        // ë‘ ê°œì˜ ìŠ¤ë ˆë“œ ìƒì„±
        Thread thread1 = new Thread(() -> {
            for (int i = 0; i < 5; i++) {
                System.out.println("ìŠ¤ë ˆë“œ 1 ì‹¤í–‰ ì¤‘...");
                try {
                    Thread.sleep(1000); // 1ì´ˆ ëŒ€ê¸°
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });

        Thread thread2 = new Thread(() -> {
            for (int i = 0; i < 5; i++) {
                System.out.println("ìŠ¤ë ˆë“œ 2 ì‹¤í–‰ ì¤‘...");
                try {
                    Thread.sleep(1000); // 1ì´ˆ ëŒ€ê¸°
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });

        // ìŠ¤ë ˆë“œ ì‹œìž‘
        thread1.start();
        thread2.start();
    }
}
```

\


## ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜ì¡´í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ 

1. ë‹¤ë¥¸ ìš´ì˜ì²´ì œ, ë‹¤ë¥¸ ë™ìž‘: ìœˆë„ìš°, ë§¥, ë¦¬ëˆ…ìŠ¤ ë“± ê° ìš´ì˜ì²´ì œëŠ” ìŠ¤ë ˆë“œë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥´ë‹¤.
2. ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥ì„±: ê°™ì€ ì½”ë“œë¼ë„ ë‹¤ë¥¸ í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ë©´ ìŠ¤ë ˆë“œ ì‹¤í–‰ ìˆœì„œë‚˜ ì‹œê°„ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆë‹¤.
3. ì´ì‹ì„± ë¬¸ì œ: ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜ì¡´í•˜ëŠ” í”„ë¡œê·¸ëž¨ì€ í•œ ì»´í“¨í„°ì—ì„œëŠ” ìž˜ ë™ìž‘í•˜ë”ë¼ë„ ë‹¤ë¥¸ ì»´í“¨í„°ì—ì„œëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìžˆë‹¤.

ì´ëŸ° ì´ìœ ë¡œ í”„ë¡œê·¸ëž¨ì˜ ì •í™•ì„±ì´ë‚˜ ì„±ëŠ¥ì´ ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì§ì ‘ ì œì–´í•˜ë ¤ í•˜ê¸°ë³´ë‹¤ëŠ”, ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì ì ˆížˆ ìœ ì§€í•˜ê³  í‘œì¤€ ë™ì‹œì„± ìœ í‹¸ë¦¬í‹°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì€ ë°©ë²•ì´ë‹¤.

\


## ì¢‹ì€ ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ëž¨ ìž‘ì„±ë²•

ì¢‹ì€ ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ëž¨ì„ ë§Œë“¤ê¸° ìœ„í•œ ë‘ ê°€ì§€ í•µì‹¬ ì›ì¹™

1. **ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì ê²Œ ìœ ì§€í•˜ê¸°**
   * ì»´í“¨í„°ì˜ CPU ì½”ì–´ ìˆ˜ë³´ë‹¤ ë„ˆë¬´ ë§Žì€ ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ì§€ ì•Šê¸°
   * ìŠ¤ë ˆë“œê°€ í•  ì¼ì´ ì—†ì„ ë•ŒëŠ” ëŒ€ê¸° ìƒíƒœì— ë‘ê¸°
2. **ë°”ìœ ëŒ€ê¸°(busy waiting) í”¼í•˜ê¸°**
   * ë°”ìœ ëŒ€ê¸°ëž€ ìŠ¤ë ˆë“œê°€ ê³„ì†í•´ì„œ ë¬´ì–¸ê°€ í™•ì¸í•˜ë©° CPUë¥¼ ì“°ëŠ” ìƒíƒœ

### ë‚˜ìœ ì˜ˆì‹œ

```java
// ë‚˜ìœ ì˜ˆ: ë°”ìœ ëŒ€ê¸°ë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ
public class SlowCountDownLatch {
    private int count;

    public SlowCountDownLatch(int count) {
        if (count < 0)
            throw new IllegalArgumentException(count + " < 0");
        this.count = count;
    }

    public void await() {
        while (true) {  // ëŠìž„ì—†ì´ í™•ì¸í•˜ëŠ” ë¬´í•œ ë£¨í”„ (ë°”ìœ ëŒ€ê¸°)
            synchronized (this) {
                if (count == 0)
                    return;
            }
        }
    }

    public synchronized void countDown() {
        if (count != 0)
            count--;
    }
}
```

### ì¢‹ì€ ì˜ˆì‹œ

```java
// ì¢‹ì€ ì˜ˆ: ìžë°”ì˜ CountDownLatch ì‚¬ìš©
import java.util.concurrent.CountDownLatch;

public class GoodExample {
    public static void main(String[] args) throws InterruptedException {
        CountDownLatch latch = new CountDownLatch(3); // 3ê°œì˜ ìž‘ì—…ì´ ëë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¼

        // 3ê°œì˜ ìž‘ì—… ìŠ¤ë ˆë“œ ìƒì„±
        for (int i = 0; i < 3; i++) {
            final int taskNum = i;
            new Thread(() -> {
                try {
                    // ìž‘ì—… ìˆ˜í–‰
                    System.out.println("ìž‘ì—… " + taskNum + " ìˆ˜í–‰ ì¤‘...");
                    Thread.sleep(1000); // ìž‘ì—… ì‹œê°„
                    System.out.println("ìž‘ì—… " + taskNum + " ì™„ë£Œ!");

                    // ìž‘ì—… ì™„ë£Œ ì‹ í˜¸
                    latch.countDown();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }).start();
        }

        // ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
        System.out.println("ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤...");
        latch.await();
        System.out.println("ëª¨ë“  ìž‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
    }
}
```

\


## í”¼í•´ì•¼ í•  ê²ƒë“¤

### 1. Thread.yield() ì‚¬ìš©í•˜ì§€ ì•Šê¸°

`Thread.yield()`ëŠ” í˜„ìž¬ ì‹¤í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ CPU ì‚¬ìš©ì„ ì–‘ë³´í•˜ëŠ” ë©”ì„œë“œë‹¤.

í•˜ì§€ë§Œ ì´ ë©”ì„œë“œëŠ” ìš´ì˜ì²´ì œë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë™ìž‘í•  ìˆ˜ ìžˆì–´ ì´ì‹ì„±ì´ ë–¨ì–´ì§„ë‹¤.

```java
// Thread.yield()ë¥¼ ì‚¬ìš©í•œ ë‚˜ìœ ì˜ˆ
public class YieldExample {
    public static void main(String[] args) {
        Thread thread = new Thread(() -> {
            for (int i = 0; i < 5; i++) {
                System.out.println("ìž‘ì—… ìˆ˜í–‰ ì¤‘...");
                // CPUë¥¼ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì— ì–‘ë³´í•˜ë ¤ëŠ” ì‹œë„ (í•˜ì§€ë§Œ íš¨ê³¼ê°€ ë³´ìž¥ë˜ì§€ ì•ŠìŒ)
                Thread.yield();
            }
        });

        thread.start();
    }
}
```

### 2. ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ì— ì˜ì¡´í•˜ì§€ ì•Šê¸°

ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ëŠ” ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì—ê²Œ ì–´ë–¤ ìŠ¤ë ˆë“œë¥¼ ë” ìžì£¼ ì‹¤í–‰í•´ì•¼ í•˜ëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ížŒíŠ¸ë‹¤.

í•˜ì§€ë§Œ ì´ ë˜í•œ ìš´ì˜ì²´ì œë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë™ìž‘í•œë‹¤.

```java
// ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ë¥¼ ì‚¬ìš©í•œ ë‚˜ìœ ì˜ˆ
public class PriorityExample {
    public static void main(String[] args) {
        Thread highPriorityThread = new Thread(() -> {
            for (int i = 0; i < 5; i++) {
                System.out.println("ë†’ì€ ìš°ì„ ìˆœìœ„ ìŠ¤ë ˆë“œ ì‹¤í–‰ ì¤‘...");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });

        Thread lowPriorityThread = new Thread(() -> {
            for (int i = 0; i < 5; i++) {
                System.out.println("ë‚®ì€ ìš°ì„ ìˆœìœ„ ìŠ¤ë ˆë“œ ì‹¤í–‰ ì¤‘...");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });

        // ìš°ì„ ìˆœìœ„ ì„¤ì • (íš¨ê³¼ê°€ ë³´ìž¥ë˜ì§€ ì•ŠìŒ)
        highPriorityThread.setPriority(Thread.MAX_PRIORITY);  // ìš°ì„ ìˆœìœ„ 10
        lowPriorityThread.setPriority(Thread.MIN_PRIORITY);   // ìš°ì„ ìˆœìœ„ 1

        highPriorityThread.start();
        lowPriorityThread.start();
    }
}
```

\


## ì¢‹ì€ ë°©ë²•ê³¼ ë‚˜ìœ ë°©ë²• ë¹„êµ

| ì¢‹ì€ ë°©ë²•                                   | ë‚˜ìœ ë°©ë²•                |
| --------------------------------------- | -------------------- |
| ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì ê²Œ ìœ ì§€                     | ë„ˆë¬´ ë§Žì€ ìŠ¤ë ˆë“œ ìƒì„±         |
| íš¨ìœ¨ì ì¸ ëŒ€ê¸° (wait/notify, CountDownLatch ë“±) | ë°”ìœ ëŒ€ê¸° (busy waiting) |
| í‘œì¤€ ë™ì‹œì„± ìœ í‹¸ë¦¬í‹° ì‚¬ìš© (java.util.concurrent)   | Thread.yield() ì‚¬ìš©    |
| ìŠ¤ë ˆë“œ í’€ ì‚¬ìš©                                | ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ì— ì˜ì¡´         |

\


## ì •ë¦¬

* í”„ë¡œê·¸ëž¨ì˜ ë™ìž‘ì„ ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ê¸°ëŒ€ì§€ ë§ìž.
* ê²¬ê³ í•˜ê³  ì´ì‹ì„± ì¢‹ì€ í”„ë¡œê·¸ëž¨ì„ ë§Œë“¤ë ¤ë©´
  * ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì ê²Œ ìœ ì§€í•˜ìž.
  * ê° ìŠ¤ë ˆë“œê°€ ìž‘ì—…ì„ ì™„ë£Œí•œ í›„ì—ëŠ” ë‹¤ìŒ ìž‘ì—…ì´ ìƒê¸¸ ë•Œê¹Œì§€ ëŒ€ê¸°í•˜ê²Œ í•˜ìž.
  * ë°”ìœ ëŒ€ê¸° ìƒíƒœë¥¼ í”¼í•˜ìž.
  * Thread.yield()ì™€ ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ì— ì˜ì¡´í•˜ì§€ ë§ìž.

\


***

## ðŸ§© ì–´ë ¤ì› ë˜ ì 

ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ë™ìž‘ ë°©ì‹ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ê°€ìž¥ ì–´ë ¤ì› ë‹¤.

íŠ¹ížˆ ë°”ìœ ëŒ€ê¸°(busy waiting)ê°€ ì™œ ë¬¸ì œì¸ì§€ ì´í•´í•˜ëŠ” ë° ì‹œê°„ì´ ê±¸ë ¸ë‹¤.

\


## ðŸ’¡ ëŠë‚€ ì 

ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ëž˜ë°ì€ ìƒê°ë³´ë‹¤ ë³µìž¡í•˜ë‹¤ëŠ” ê²ƒì„ ëŠê¼ˆë‹¤.

ë‹¨ìˆœížˆ ì½”ë“œê°€ ëŒì•„ê°€ê²Œ ë§Œë“œëŠ” ê²ƒë³´ë‹¤ ê²¬ê³ í•˜ê³  ì´ì‹ì„± ìžˆëŠ” ì½”ë“œë¥¼ ë§Œë“œëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤ëŠ” ì ì„ ê¹¨ë‹¬ì•˜ë‹¤.

"ë¹ ë¥´ê²Œ ê°€ë ¤ë©´ í˜¼ìž ê°€ê³ , ë©€ë¦¬ ê°€ë ¤ë©´ í•¨ê»˜ ê°€ë¼"ëŠ” ë§ì²˜ëŸ¼, ë‹¨ê¸°ì ì¸ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜ì¡´í•˜ê¸°ë³´ë‹¤ëŠ” í‘œì¤€ì ì¸ ë°©ë²•ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìž¥ê¸°ì ìœ¼ë¡œ ë” ì¢‹ì€ ì„ íƒì´ë¼ëŠ” ê²ƒì„ ë°°ì› ë‹¤.
