# ğŸ“˜ ì´í™í‹°ë¸Œ ìë°” ìŠ¤í„°ë””

## ğŸ“ ì•„ì´í…œ 7: ë‹¤ ì“´ ê°ì²´ ì°¸ì¡°ë¥¼ í•´ì œí•˜ë¼

### ğŸ”¹ ìš”ì•½

âœ… GC(ê°€ë¹„ì§€ ì»¬ë ‰í„°)ê°€ ìë™ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ íšŒìˆ˜í•˜ì§€ë§Œ, ì—¬ì „íˆ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ  
âœ… ë‹¤ ì“´ ê°ì²´ì˜ ì°¸ì¡°ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í•´ì œí•´ì•¼ í•¨  
âœ… ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ì£¼ìš” ì „ëµ:

- `null` í• ë‹¹ì„ í†µí•œ ì°¸ì¡° í•´ì œ
- ìŠ¤ì½”í”„ ì¶•ì†Œ
- `WeakReference` í™œìš©
- `try-with-resources` ì‚¬ìš©

---

### ğŸ“š ì¶”ê°€ ê°œë…

#### ğŸ”¹ Java ë©”ëª¨ë¦¬ êµ¬ì¡°

> ğŸ’¡ **Javaì˜ ë©”ëª¨ë¦¬ ëª¨ë¸**
>
> <p align="center">
>   <img src="image.png" width="300" alt="Javaì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°" />
> </p>
> - Java í”„ë¡œê·¸ë¨ì€ ë©”ëª¨ë¦¬ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê°ì²´ë“¤ì„ ê´€ë¦¬í•˜ëŠ” ë°, **í™(Heap)**ê³¼ **ìŠ¤íƒ(Stack)** ë©”ëª¨ë¦¬ ë‘ ê°€ì§€ ì£¼ìš” ì˜ì—­ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
>   - **í™(Heap)**: ê°ì²´ê°€ ë™ì ìœ¼ë¡œ í• ë‹¹ë˜ëŠ” ê³µê°„ìœ¼ë¡œ, JVMì—ì„œ ê°€ë¹„ì§€ ì»¬ë ‰í„°(GC)ê°€ ì´ ê³µê°„ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
>   - **ìŠ¤íƒ(Stack)**: ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ìƒì„±ë˜ëŠ” ë¡œì»¬ ë³€ìˆ˜ë“¤ì´ ì €ì¥ë˜ëŠ” ê³µê°„ìœ¼ë¡œ, ë©”ì„œë“œê°€ ì¢…ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ë©”ëª¨ë¦¬ê°€ í•´ì œë©ë‹ˆë‹¤.

#### ğŸ”‘ **ë©”ëª¨ë¦¬ ê´€ë¦¬ì˜ ì¤‘ìš”ì„±**

- ê°ì²´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜(Memory Leak)**ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ì²´ê°€ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šì§€ë§Œ ì—¬ì „íˆ ì°¸ì¡°ë˜ê³  ìˆìœ¼ë©´, ê°€ë¹„ì§€ ì»¬ë ‰í„°ê°€ í•´ë‹¹ ê°ì²´ë¥¼ íšŒìˆ˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

---

#### ğŸ”¹ ê°€ë¹„ì§€ ì»¬ë ‰í„°(GC)

#### ğŸ’¡ **GC(ê°€ë¹„ì§€ ì»¬ë ‰í„°)ë€?**

- **ê°€ë¹„ì§€ ì»¬ë ‰í„°(GC)**ëŠ” ìë°” í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ê°ì²´ë“¤ì„ ìë™ìœ¼ë¡œ ë©”ëª¨ë¦¬ì—ì„œ íšŒìˆ˜í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. GCëŠ” JVMì— ë‚´ì¥ë˜ì–´ ìˆìœ¼ë©°, ë©”ëª¨ë¦¬ë¥¼ ìë™ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.
- GCì˜ ì£¼ìš” ì‘ì—…ì€ **ë§ˆí¬-ìŠ¤ìœ•(Mark-Sweep)** ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ ê°ì²´ë“¤ì„ ì°¾ì•„ ì œê±°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

#### ğŸ’¡ **GCì™€ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜**

- GCê°€ ìë™ìœ¼ë¡œ ë©”ëª¨ë¦¬ ê´€ë¦¬í•˜ì§€ë§Œ, **ê°•í•œ ì°¸ì¡°**ë¥¼ í†µí•´ ì—¬ì „íˆ ê°ì²´ê°€ ë©”ëª¨ë¦¬ì—ì„œ í•´ì œë˜ì§€ ì•Šìœ¼ë©´ **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜**ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ `null`ë¡œ ì°¸ì¡°ë¥¼ í•´ì œí•˜ê±°ë‚˜ **ì•½í•œ ì°¸ì¡°(WeakReference)**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìœ ìš©í•©ë‹ˆë‹¤.

---

#### ğŸ”¹ **WeakReference**

#### ğŸ’¡ **WeakReferenceë€?**

- **WeakReference**ëŠ” ê°ì²´ì— ëŒ€í•œ **ì•½í•œ ì°¸ì¡°**ë¥¼ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤ë¡œ, í•´ë‹¹ ê°ì²´ê°€ **ê°€ë¹„ì§€ ì»¬ë ‰ì…˜**ì˜ ëŒ€ìƒì´ ë˜ë„ë¡ í•©ë‹ˆë‹¤. ì¦‰, **ê°•í•œ ì°¸ì¡°ê°€ ì—†ìœ¼ë©´** í•´ë‹¹ ê°ì²´ëŠ” GCì— ì˜í•´ íšŒìˆ˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **WeakReference**ëŠ” **ìºì‹œ**ë‚˜ **ë©”ëª¨ë¦¬ ìµœì í™”**ì™€ ê°™ì€ ì‘ì—…ì—ì„œ ìì£¼ ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìºì‹œëœ ê°ì²´ê°€ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šìœ¼ë©´ ê°€ë¹„ì§€ ì»¬ë ‰í„°ê°€ ì´ë¥¼ íšŒìˆ˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

### ğŸ¯ ì¤‘ìš”í•œ ì 

ğŸ”¹ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ëŠ” ë°œê²¬í•˜ê¸° ì–´ë ¤ì›Œì„œ ì‚¬ì „ì— ì˜ˆë°©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•¨  
ğŸ”¹ ìºì‹œë¥¼ ì‚¬ìš©í•  ë•Œ ê°•í•œ ì°¸ì¡°ë¥¼ ìœ ì§€í•˜ë©´ ë¶ˆí•„ìš”í•œ ê°ì²´ê°€ ë‚¨ì„ ìˆ˜ ìˆìŒ â†’ `WeakHashMap` í™œìš© ê³ ë ¤  
ğŸ”¹ ë¦¬ìŠ¤ë„ˆë‚˜ ì½œë°±ì„ ë“±ë¡í–ˆìœ¼ë©´ ëª…í™•íˆ í•´ì œí•´ì•¼ í•¨

---

### ğŸ’¡ ì½”ë“œ ì˜ˆì œ ë° ì„¤ëª…

```mermaid
flowchart LR
    A["[ packet1 | packet2 | packet3 | null | null ]"] --> B["result = 10"]
    B --> C["[ packet2 | packet3 | null | null | null ]"]
```

#### âŒ ì˜ëª»ëœ ì˜ˆì œ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°œìƒ)

```java
public class YouTubeQueue {
    private Object[] packets;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 8;

    public YouTubeQueue() {
        packets = new Object[DEFAULT_INITIAL_CAPACITY];
    }

    public YouTubeQueue(int capacity) {
        packets = new Object[capacity];
    }

    public void offer(Object p) {
        ensureCapacity();
        packets[size++] = p;
    }

    public Object poll() {
        if (size == 0) throw new NoSuchElementException("íê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");

        Object result = packets[0];  // íì—ì„œ êº¼ë‚¼ ì²« ë²ˆì§¸ ìš”ì†Œë¥¼ ì €ì¥
        System.arraycopy(packets, 1, packets, 0, --size); // âŒ ì°¸ì¡°ê°€ ë‚¨ì•„ìˆìŒ â†’ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°œìƒ ê°€ëŠ¥
        return result;
    }

    private void ensureCapacity() {
        if (packets.length == size)
            packets = Arrays.copyOf(packets 2 * size + 1)
    }
}
```

#### âœ… ê°œì„ ëœ ì˜ˆì œ (ë‹¤ ì“´ ê°ì²´ ì°¸ì¡° í•´ì œ)

```java
public class YouTubeQueue {
    private Object[] packets;
    private int size = 0;
    private static final int DEFAULT_INITIAL_CAPACITY = 8;

    public YouTubeQueue() {
        packets = new Object[DEFAULT_INITIAL_CAPACITY];
    }

    public YouTubeQueue(int capacity) {
        packets = new Object[capacity];
    }

    public void offer(Object p) {
        ensureCapacity();
        packets[size++] = p;
    }

    public Object poll() {
        if (size == 0) throw new NoSuchElementException("íê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");

        Object result = packets[0];  // íì—ì„œ êº¼ë‚¼ ì²« ë²ˆì§¸ ìš”ì†Œë¥¼ ì €ì¥
        System.arraycopy(packets, 1, packets, 0, --size);  // ìš”ì†Œë¥¼ ì•ìœ¼ë¡œ ì´ë™
        packets[size] = null;  âœ… ë‹¤ ì“´ ê°ì²´ ì°¸ì¡° í•´ì œ
        return result;

    }

    private void ensureCapacity() {
        if (packets.length == size)
            packets = Arrays.copyOf(packets 2 * size + 1)
    }
}
```

---

### â— ì–´ë ¤ì› ë˜ ì 

âš ï¸ ì°¸ì¡° í•´ì œë¥¼ í•œë‹¤ê³  í•´ì„œ ë°°ì—´ì˜ í•œ ìš”ì†Œê°€ ë©”ëª¨ë¦¬ì—ì„œ í•´ì œë˜ì§€ ì•ŠëŠ”ë° ì°¸ì¡° í•´ì œê°€ ì™œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë§‰ëŠ” ë°©ë²•ì¸ì§€ ì˜ë¬¸ì´ ìˆì—ˆìŒ â¡ï¸ ì°¸ì¡°ë¥¼ í•´ì œí•˜ëŠ” ê²ƒì€ ë°°ì—´ ìì²´ê°€ ì•„ë‹ˆë¼ ë°°ì—´ ì•ˆì˜ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ í•´ì œí•˜ëŠ” ê²ƒì„ìœ¼ë¡œ í•´ë‹¹ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ëª…ì‹œì ìœ¼ë¡œ nullë¡œ í•´ì œí•˜ëŠ” ê²ƒì´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ë°©ì§€í•˜ëŠ” ë°©ë²•ì´ë¼ëŠ” ì ì„ ì´í•´í•¨

âš ï¸ `WeakReference`, `SoftReference` ê°™ì€ ìƒì†Œí•œ ê°œë…ì´ ìˆì–´ ì–´ë ¤ì› ìŒ

---

### ğŸ’­ ëŠë‚€ ì 

ğŸ’¡
ğŸ’¡ ìºì‹œë‚˜ ì½œë°±ì„ ì‚¬ìš©í•  ë•ŒëŠ” ë°˜ë“œì‹œ ì •ë¦¬í•˜ëŠ” ìŠµê´€ì„ ë“¤ì—¬ì•¼ê² ë‹¤ê³  ìƒê°í•¨
